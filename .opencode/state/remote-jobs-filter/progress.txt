# Progress Log
PRD: remote-jobs-filter
Started: 2026-01-30

## Codebase Patterns
- Boolean settings follow three-field pattern: `fieldName`, `defaultFieldName`, `overrideFieldName`
- Settings stored in database as '1' (true) / '0' (false) / null
- Test fixtures in *.test.tsx files must include all AppSettings fields

---
<!-- Task logs below - APPEND ONLY -->

## Task - types-1
- Added `jobspyIsRemote`, `defaultJobspyIsRemote`, and `overrideJobspyIsRemote` fields to AppSettings interface
- Files changed:
  - orchestrator/src/shared/types.ts:531-533 - Added three boolean fields after jobspyLinkedinFetchDescription
  - orchestrator/src/client/pages/SettingsPage.test.tsx:100-102 - Updated test fixture with default values
- **Learnings:** Boolean settings consistently use three-field pattern (value, default, override). All test fixtures must be updated when adding new settings fields to AppSettings interface.

## Task - types-2
- Added `jobspyIsRemote` validation schema to updateSettingsSchema
- Files changed:
  - orchestrator/src/shared/settings-schema.ts:63 - Added `jobspyIsRemote: z.boolean().nullable().optional()` after jobspyLinkedinFetchDescription
- **Learnings:** Validation schemas use Zod with `.boolean().nullable().optional()` pattern for boolean settings. Schema placement follows the same order as the TypeScript types.

## Task - db-1
- Added `jobspyIsRemote` to SettingKey type union in settings repository
- Files changed:
  - orchestrator/src/server/repositories/settings.ts:31 - Added "jobspyIsRemote" to SettingKey type union after "jobspyLinkedinFetchDescription"
- **Learnings:** The SettingKey type union defines all valid setting keys that can be stored/retrieved from the database. Each new setting must be added to this type for TypeScript safety.

## Task - api-1
- Added `jobspyIsRemote` storage logic to settings API route
- Files changed:
  - orchestrator/src/server/api/routes/settings.ts:221-228 - Added storage block after jobspyLinkedinFetchDescription that converts boolean to '1'/'0' string for database storage
- **Learnings:** Settings API route follows consistent pattern: check if field exists in input, extract value with null coalescing, store using ternary conversion (val ? '1' : '0'). All boolean settings stored as strings in database.

## Task - service-1
- Added `jobspyIsRemote` retrieval logic to settings service with environment variable support
- Files changed:
  - orchestrator/src/server/services/settings.ts:172-181 - Added defaultJobspyIsRemote, overrideJobspyIsRemote, and merge logic after jobspyLinkedinFetchDescription
  - orchestrator/src/server/services/settings.ts:232-234 - Added three fields to return object
- **Learnings:** Settings service follows pattern: parse default from env var with fallback, parse override from database (checks for '1' or 'true'), merge using nullish coalescing (override ?? default). Environment variable JOBSPY_IS_REMOTE defaults to '0' (false) if not set.

## Task - jobspy-1
- Added `isRemote` parameter to JobSpy service interface and implementation
- Files changed:
  - orchestrator/src/server/services/jobspy.ts:116 - Added `isRemote?: boolean` to RunJobSpyOptions interface
  - orchestrator/src/server/services/jobspy.ts:178-180 - Added JOBSPY_IS_REMOTE environment variable passing using pattern `String(options.isRemote ?? process.env.JOBSPY_IS_REMOTE ?? "0")`
- **Learnings:** JobSpy service passes parameters to Python script via environment variables. Boolean values are converted to strings using String() function. Follows nullish coalescing pattern: option parameter ?? env var ?? default value.
